import { useSignInWithOAuth as g } from "@coinbase/cdp-hooks";
import { useState as c, useRef as f, useCallback as m } from "react";
import { useOauthStatusModal as A } from "../../OAuthStatusModal/index.js";
import { isApiError as I } from "../../../utils/isApiError.js";
const E = () => {
  const { signInWithOAuth: n } = g(), [r, s] = c(!1), [l, e] = c(null), o = f(null), i = "An error occurred while signing in. Please try again.", { persistOAuthState: u } = A();
  return {
    signInWithOAuth: m(
      async (a) => {
        if (!r) {
          o.current = a, s(!0), e(null);
          try {
            await n(a), u(!1);
          } catch (t) {
            const h = I(t) ? t : t instanceof Error && t.message || i;
            e(h), s(!1), console.error(t);
          }
        }
      },
      [r, n, u]
    ),
    oauthProvider: o,
    isPending: r,
    error: l
  };
};
export {
  E as useSignInWithOAuth
};
