import { hashMessage as n } from "viem";
import { signAndWrapTypedDataForSmartAccount as i } from "./index.web56.js";
import { validateUserOwnsSmartAccount as c, EIP1193ProviderError as d, STANDARD_ERROR_CODES as u } from "./index.web34.js";
async function p(r, a) {
  const [o, e] = r, s = await c(e);
  try {
    const { signature: t } = await i({
      smartAccount: e,
      ownerAddress: s.evmAccounts[0],
      hash: g(o),
      chainId: a.getState().chainId
    });
    return t;
  } catch (t) {
    throw new d(
      u.provider.userRejectedRequest,
      t instanceof Error ? t.message : "Signing failed"
    );
  }
}
function g(r) {
  return typeof r == "string" ? n({ raw: r }) : n(r);
}
export {
  p as handlePersonalSign
};
