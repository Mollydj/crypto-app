import { isAddress as f } from "./index156.js";
import { isAddressEqual as o } from "./index166.js";
function l(n) {
  const { address: r, domain: s, message: e, nonce: t, scheme: a, time: i = /* @__PURE__ */ new Date() } = n;
  if (s && e.domain !== s || t && e.nonce !== t || a && e.scheme !== a || e.expirationTime && i >= e.expirationTime || e.notBefore && i < e.notBefore)
    return !1;
  try {
    if (!e.address || !f(e.address, { strict: !1 }) || r && !o(e.address, r))
      return !1;
  } catch {
    return !1;
  }
  return !0;
}
export {
  l as validateSiweMessage
};
