function u(n, { errorInstance: i = new Error("timed out"), timeout: t, signal: l }) {
  return new Promise((a, o) => {
    (async () => {
      let e;
      try {
        const r = new AbortController();
        t > 0 && (e = setTimeout(() => {
          l && r.abort();
        }, t)), a(await n({ signal: r?.signal || null }));
      } catch (r) {
        r?.name === "AbortError" && o(i), o(r);
      } finally {
        clearTimeout(e);
      }
    })();
  });
}
export {
  u as withTimeout
};
