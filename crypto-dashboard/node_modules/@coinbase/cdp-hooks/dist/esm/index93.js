import { hashMessage as g } from "./index207.js";
import { parseSiweMessage as l } from "./index260.js";
import { validateSiweMessage as p } from "./index261.js";
import { verifyHash as h } from "./index259.js";
async function S(a, r) {
  const { address: i, domain: t, message: s, nonce: o, scheme: n, signature: d, time: m = /* @__PURE__ */ new Date(), ...f } = r, e = l(s);
  if (!e.address || !p({
    address: i,
    domain: t,
    message: e,
    nonce: o,
    scheme: n,
    time: m
  }))
    return !1;
  const c = g(s);
  return h(a, {
    address: e.address,
    hash: c,
    signature: d,
    ...f
  });
}
export {
  S as verifySiweMessage
};
